# ポートフォリオ管理アプリケーション

## 概要

このアプリケーションは投資ポートフォリオを管理するためのツールです。複数のデータソースから株価情報を取得し、資産配分の視覚化、リバランス計算、手数料・配当の分析などの機能を提供します。

## 株価データ取得システム

### 概要

このシステムは複数のデータソースを組み合わせて株価情報を効率的かつ信頼性高く取得します。銘柄タイプに応じて最適なAPIを選択し、主要APIが失敗した場合は代替APIを試行する堅牢な仕組みを採用しています。

### 処理フロー図

![株価取得システムのフロー図](./images/stock-price-fetching-diagram.svg)

### 主な機能

1. **銘柄タイプの自動判定**
   - 日本株/投資信託: Yahoo Finance APIを優先使用
   - 米国株: Alpaca APIを優先使用

2. **複数データソースの活用**
   - Yahoo Finance API: 日本株と投資信託のプライマリソース
   - Alpaca API: 米国株のプライマリソース
   - Alpha Vantage API: 代替データソース
   - Python yfinance: プログラムによる代替実装

3. **エラーハンドリングとフォールバックメカニズム**
   - API制限、タイムアウト、ネットワークエラーに対応
   - すべてのAPIが失敗した場合の合理的なデフォルト値生成
   - ユーザーへの明示的な通知

4. **データの拡張**
   - 手数料率の自動推定
   - 配当情報の取得と推定
   - 銘柄タイプと属性の分析

## インストール方法

```bash
# 依存パッケージのインストール
npm install

# 開発サーバーの起動
npm start

# ビルド
npm run build
```

## 環境変数の設定

`.env`ファイルを作成し、以下の環境変数を設定します。

```
REACT_APP_ALPHA_VANTAGE_API_KEY=あなたのAlpha Vantage APIキー
REACT_APP_ALPACA_API_KEY=あなたのAlpaca APIキー
REACT_APP_ALPACA_API_SECRET=あなたのAlpaca APIシークレット
REACT_APP_GOOGLE_CLIENT_ID=あなたのGoogle OAuth ClientID
```

## API関連の設定

API呼び出しはNetlifyの関数を通じて行われます。`netlify.toml`ファイルで以下の設定が定義されています：

```toml
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200
  force = true
```

## 既知のバグと制限事項

1. **日本の投資信託・個別株の取得エラー**
   - yfinanceが動作せず、外部公開可能な無料APIが見つかっていないため実装が困難
   - J-Quants APIが使いたかったが、外部公開するアプリで使うことは規約違反になる
   - 作者がアメリカ在住であるため日本の証券口座開設ができず、証券口座のAPIが利用できない
   - なお、アメリカの証券口座は開設できるため、アメリカの株価は取得できる

2. **API制限による取得エラー**
   - Alpha Vantage APIの無料プランでは1分間に5リクエスト、1日に500リクエストという制限あり
   - 多数の銘柄を一度に更新する際にエラーが発生する可能性あり

3. **データソースの鮮度と精度**
   - 無料APIのため、データの更新頻度に制限あり
   - 特に日本株・投資信託のデータはリアルタイム性が低い場合あり

## 今後の開発予定

1. 保有資産の時系列データ保存と可視化
2. パフォーマンス分析機能の強化
3. より多くのデータソースのサポート
4. UI/UXの改善

## 貢献方法

1. このリポジトリをフォーク
2. 新しいブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add some amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## 免責事項

本アプリケーションの利用に関しては、以下の点にご留意ください：

1. **投資判断について**
   - 本アプリケーションで提供される情報は、投資判断の参考として提供されるものであり、投資アドバイスではありません
   - すべての投資判断は利用者自身の責任において行ってください
   - 投資は元本を保証するものではなく、市場の変動により損失が生じる可能性があります

2. **データの信頼性**
   - 本アプリケーションが提供する株価、為替レート、配当情報などのデータは、第三者のAPIから取得しており、その正確性・完全性・最新性を保証するものではありません
   - 特に無料APIの制限により、一部データが最新でない場合や、フォールバック値（推定値）が使用される場合があります
   - 重要な投資判断を行う際は、正規の金融情報サービスや証券会社の情報を確認することを強く推奨します

3. **アプリケーションの使用**
   - 本アプリケーションの使用はユーザー自身の責任において行ってください
   - アプリケーションの不具合、予期せぬ動作、データ喪失などにより生じた損害について、開発者は一切の責任を負いません
   - アプリケーションの使用により直接的または間接的に発生したいかなる損失や損害についても、開発者は責任を負いません

4. **専門家への相談**
   - 投資に関する決定を行う前に、必要に応じて資格を持つ財務アドバイザーや証券会社などの専門家に相談することをお勧めします

5. **法的制限**
   - 本アプリケーションの利用は、各ユーザーが所在する国や地域の法律・規制に準拠する必要があります
   - 一部の国や地域では投資関連サービスに特定の制限がある場合があります

6. **継続的サポート**
   - 本アプリケーションの継続的な保守や更新は保証されません
   - APIの変更や第三者サービスの終了により、機能が制限される可能性があります

本アプリケーションを使用することで、上記の免責事項に同意したものとみなされます。

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。
