<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
  <!-- 背景色 -->
  <rect width="800" height="600" fill="#f8f9fa" />
  
  <!-- タイトル -->
  <text x="400" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold">株価取得システムのフロー</text>
  
  <!-- 開始ポイント -->
  <circle cx="400" cy="80" r="20" fill="#4CAF50" />
  <text x="400" y="85" font-family="Arial" font-size="12" text-anchor="middle" fill="white">開始</text>
  
  <!-- フロー線 -->
  <line x1="400" y1="100" x2="400" y2="130" stroke="#333" stroke-width="2" />
  
  <!-- ティッカーシンボル入力 -->
  <rect x="300" y="130" width="200" height="40" rx="5" fill="#E3F2FD" stroke="#2196F3" />
  <text x="400" y="155" font-family="Arial" font-size="14" text-anchor="middle">ティッカーシンボル入力</text>
  
  <!-- フロー線 -->
  <line x1="400" y1="170" x2="400" y2="200" stroke="#333" stroke-width="2" />
  
  <!-- 日本株/米国株判定 -->
  <polygon points="400,200 475,250 400,300 325,250" fill="#FFF9C4" stroke="#FFC107" />
  <text x="400" y="255" font-family="Arial" font-size="12" text-anchor="middle">日本株または投資信託？</text>
  
  <!-- フロー線 - Yes -->
  <line x1="325" y1="250" x2="200" y2="250" stroke="#333" stroke-width="2" />
  <text x="280" y="240" font-family="Arial" font-size="12" fill="#333">Yes</text>
  
  <!-- フロー線 - No -->
  <line x1="475" y1="250" x2="600" y2="250" stroke="#333" stroke-width="2" />
  <text x="530" y="240" font-family="Arial" font-size="12" fill="#333">No</text>
  
  <!-- Yahoo Finance API -->
  <rect x="100" y="230" width="200" height="40" rx="5" fill="#E8EAF6" stroke="#3F51B5" />
  <text x="200" y="255" font-family="Arial" font-size="14" text-anchor="middle">Yahoo Finance API</text>
  
  <!-- Alpaca API -->
  <rect x="500" y="230" width="200" height="40" rx="5" fill="#E8EAF6" stroke="#3F51B5" />
  <text x="600" y="255" font-family="Arial" font-size="14" text-anchor="middle">Alpaca API</text>
  
  <!-- フロー線 - Yahoo -->
  <line x1="200" y1="270" x2="200" y2="330" stroke="#333" stroke-width="2" />
  
  <!-- フロー線 - Alpaca -->
  <line x1="600" y1="270" x2="600" y2="330" stroke="#333" stroke-width="2" />
  
  <!-- Yahoo成功判定 -->
  <polygon points="200,330 275,380 200,430 125,380" fill="#FFF9C4" stroke="#FFC107" />
  <text x="200" y="385" font-family="Arial" font-size="12" text-anchor="middle">成功？</text>
  
  <!-- Alpaca成功判定 -->
  <polygon points="600,330 675,380 600,430 525,380" fill="#FFF9C4" stroke="#FFC107" />
  <text x="600" y="385" font-family="Arial" font-size="12" text-anchor="middle">成功？</text>
  
  <!-- フロー線 - Yahoo - Yes -->
  <line x1="125" y1="380" x2="50" y2="380" stroke="#333" stroke-width="2" />
  <text x="100" y="370" font-family="Arial" font-size="12" fill="#333">Yes</text>
  
  <!-- フロー線 - Yahoo - No -->
  <line x1="275" y1="380" x2="350" y2="380" stroke="#333" stroke-width="2" />
  <text x="300" y="370" font-family="Arial" font-size="12" fill="#333">No</text>
  
  <!-- フロー線 - Alpaca - Yes -->
  <line x1="525" y1="380" x2="480" y2="380" stroke="#333" stroke-width="2" />
  <text x="500" y="370" font-family="Arial" font-size="12" fill="#333">Yes</text>
  
  <!-- フロー線 - Alpaca - No -->
  <line x1="675" y1="380" x2="725" y2="380" stroke="#333" stroke-width="2" />
  <text x="700" y="370" font-family="Arial" font-size="12" fill="#333">No</text>
  
  <!-- Yahoo結果 -->
  <rect x="10" y="360" width="80" height="40" rx="5" fill="#E8F5E9" stroke="#4CAF50" />
  <text x="50" y="385" font-family="Arial" font-size="12" text-anchor="middle">データ取得</text>
  
  <!-- Alpacaデータ -->
  <rect x="400" y="360" width="80" height="40" rx="5" fill="#E8F5E9" stroke="#4CAF50" />
  <text x="440" y="385" font-family="Arial" font-size="12" text-anchor="middle">データ取得</text>
  
  <!-- Yahoo失敗 - 代替API -->
  <rect x="300" y="360" width="100" height="40" rx="5" fill="#FFEBEE" stroke="#F44336" />
  <text x="350" y="385" font-family="Arial" font-size="12" text-anchor="middle">代替API試行</text>
  
  <!-- Alpaca失敗 - Yahoo API -->
  <rect x="705" y="360" width="90" height="40" rx="5" fill="#FFEBEE" stroke="#F44336" />
  <text x="750" y="385" font-family="Arial" font-size="12" text-anchor="middle">Yahoo試行</text>
  
  <!-- フロー線 - Yahoo結果 -->
  <line x1="50" y1="400" x2="50" y2="480" stroke="#333" stroke-width="2" />
  
  <!-- フロー線 - Alpacaデータ -->
  <line x1="440" y1="400" x2="440" y2="450" stroke="#333" stroke-width="2" />
  
  <!-- フロー線 - Yahoo失敗 -->
  <line x1="350" y1="400" x2="350" y2="450" stroke="#333" stroke-width="2" />
  
  <!-- フロー線 - Alpaca失敗 -->
  <line x1="750" y1="400" x2="750" y2="450" stroke="#333" stroke-width="2" />
  
  <!-- 代替API判定 -->
  <polygon points="350,450 400,480 350,510 300,480" fill="#FFF9C4" stroke="#FFC107" />
  <text x="350" y="485" font-family="Arial" font-size="10" text-anchor="middle">代替API成功？</text>
  
  <!-- Yahoo API判定 -->
  <polygon points="750,450 800,480 750,510 700,480" fill="#FFF9C4" stroke="#FFC107" />
  <text x="750" y="485" font-family="Arial" font-size="10" text-anchor="middle">Yahoo成功？</text>
  
  <!-- フロー線 - 代替API - Yes -->
  <line x1="300" y1="480" x2="250" y2="480" stroke="#333" stroke-width="2" />
  <text x="280" y="470" font-family="Arial" font-size="10" fill="#333">Yes</text>
  
  <!-- フロー線 - 代替API - No -->
  <line x1="400" y1="480" x2="450" y2="480" stroke="#333" stroke-width="2" />
  <text x="425" y="470" font-family="Arial" font-size="10" fill="#333">No</text>
  
  <!-- フロー線 - Yahoo - Yes -->
  <line x1="700" y1="480" x2="650" y2="480" stroke="#333" stroke-width="2" />
  <text x="675" y="470" font-family="Arial" font-size="10" fill="#333">Yes</text>
  
  <!-- フロー線 - Yahoo - No -->
  <line x1="800" y1="480" x2="770" y2="480" x2="770" y2="520" stroke="#333" stroke-width="2" stroke-dasharray="5,5" />
  <text x="785" y="470" font-family="Arial" font-size="10" fill="#333">No</text>
  
  <!-- 代替APIデータ -->
  <rect x="170" y="460" width="80" height="40" rx="5" fill="#E8F5E9" stroke="#4CAF50" />
  <text x="210" y="485" font-family="Arial" font-size="12" text-anchor="middle">データ取得</text>
  
  <!-- フォールバック値 -->
  <rect x="450" y="460" width="100" height="40" rx="5" fill="#FCE4EC" stroke="#E91E63" />
  <text x="500" y="485" font-family="Arial" font-size="12" text-anchor="middle">フォールバック値</text>
  
  <!-- Yahoo APIデータ -->
  <rect x="570" y="460" width="80" height="40" rx="5" fill="#E8F5E9" stroke="#4CAF50" />
  <text x="610" y="485" font-family="Arial" font-size="12" text-anchor="middle">データ取得</text>
  
  <!-- Alpacaフォールバック値 -->
  <rect x="720" y="520" width="100" height="40" rx="5" fill="#FCE4EC" stroke="#E91E63" />
  <text x="770" y="545" font-family="Arial" font-size="12" text-anchor="middle">フォールバック値</text>
  
  <!-- フロー線 - 最終結果線 -->
  <line x1="50" y1="480" x2="50" y2="540" stroke="#333" stroke-width="2" />
  <line x1="210" y1="500" x2="210" y2="540" stroke="#333" stroke-width="2" />
  <line x1="440" y1="450" x2="440" y2="540" stroke="#333" stroke-width="2" />
  <line x1="500" y1="500" x2="500" y2="540" stroke="#333" stroke-width="2" />
  <line x1="610" y1="500" x2="610" y2="540" stroke="#333" stroke-width="2" />
  <line x1="770" y1="560" x2="770" y2="580" stroke="#333" stroke-width="2" />
  
  <!-- 横線 -->
  <line x1="50" y1="540" x2="610" y2="540" stroke="#333" stroke-width="2" />
  
  <!-- 最終結果への線 -->
  <line x1="400" y1="540" x2="400" y2="560" stroke="#333" stroke-width="2" />
  
  <!-- 結果処理 -->
  <rect x="300" y="560" width="200" height="40" rx="5" fill="#DCEDC8" stroke="#8BC34A" />
  <text x="400" y="585" font-family="Arial" font-size="14" text-anchor="middle">データ処理 &amp; UI表示</text>
  
  <!-- 横線（フォールバック） -->
  <line x1="400" y1="580" x2="770" y2="580" stroke="#333" stroke-width="2" />
</svg>
