# ドキュメントとソースコード整合性確認プロンプト

## 目的

Portfolio Managerアプリケーションのドキュメント（仕様書、API仕様書、インターフェース仕様書、セットアップガイド、コード規約書）とソースコードの整合性を確認し、必要に応じてドキュメントを更新することを目的としています。

## 実施内容

以下の観点でソースコードとドキュメントの整合性を確認し、齟齬がある場合はソースコードに合わせてドキュメントを更新してください。

### 1. ファイル構造の確認

ソースコードの実際のファイル構造が、コード規約書（updated-code-conventions.txt）の「2.1 ディレクトリ構造」セクションに記載されている構造と一致しているか確認してください。

```
src/
├── components/      # UIコンポーネント
│   ├── auth/        # 認証関連コンポーネント 
│   ├── common/      # 共通UIコンポーネント
│   ├── dashboard/   # ダッシュボード画面コンポーネント
│   ├── data/        # データ連携コンポーネント
│   ├── layout/      # レイアウト関連コンポーネント
│   ├── settings/    # 設定画面コンポーネント
│   └── simulation/  # シミュレーション画面コンポーネント
├── context/         # React Context定義
├── hooks/           # カスタムReact Hooks
├── pages/           # ページコンポーネント
├── services/        # APIサービスとデータ処理
├── utils/           # ユーティリティ関数
└── App.jsx          # アプリケーションルート

functions/
├── alpaca-api-proxy.js        # Alpaca APIプロキシ（米国株向け）
├── yfinance-api-proxy.js      # Yahoo Finance APIプロキシ（日本株・投資信託向け）
├── exchangerate-proxy.js      # exchangerate.host APIプロキシ（為替レート向け）
```

追加・変更・削除されたディレクトリやファイルがある場合は、それに合わせてドキュメントを更新してください。

### 2. API実装状態の確認

API仕様書（API-specification）に記載されているAPIエンドポイントと実際のコードベースに実装されているAPIエンドポイントを比較してください。

特に以下の点を確認：
- 記載されているすべてのエンドポイントが実装されているか
- 実装されているが仕様書に記載のないエンドポイントはないか
- パラメータ、レスポンス形式、エラーハンドリングなどが一致しているか
- スクレイピング処理とAPI連携のフローが記載どおり実装されているか

### 3. 機能実装状態の確認

インターフェース仕様書（updated-interface-specifications.txt）に記載されている機能と実際のコードベースで実装されている機能を比較してください。

特に以下の点を確認：
- AIプロンプト生成機能
- マルチ通貨シミュレーション
- スクレイピングによる株価取得
- Googleドライブ連携
- 通知システム

### 4. コード規約準拠の確認

コード規約書（updated-code-conventions.txt）に記載されている命名規則、コーディングスタイル、エラーハンドリングなどの規約がソースコードで守られているか確認してください。

特に以下の点を確認：
- 変数・関数名の命名規則
- コンポーネント定義の方法
- フック使用のルール
- エラーハンドリングの実装
- データソース管理

### 5. 環境変数とセットアップ状況の確認

セットアップガイド（updated-setup-guide.txt）に記載されている環境変数や設定項目が、実際のコードベースと一致しているか確認してください。

特に以下の点を確認：
- 必要な環境変数
- 依存パッケージ
- スクレイピング設定
- APIキー設定

## 更新方法

確認の結果、不整合が見つかった場合は以下の手順で対応してください：

1. **ソースコードを正としてドキュメントを更新する**：ソースコードの実装を基準として、ドキュメントを修正します。
2. **相違点をリストアップ**：見つかった不整合をカテゴリごとにリストアップします。
3. **更新内容を明記**：ドキュメントの更新内容を明確に記述します。
4. **改訂履歴の更新**：各ドキュメントの改訂履歴セクションを更新し、変更内容、日付、担当者を記録します。

## 報告内容

整合性確認と更新作業の結果として、以下の情報を報告してください：

1. 確認したドキュメントとソースコードの対象範囲
2. 発見された不整合のリスト（カテゴリ別）
3. 更新対象のドキュメントと更新内容
4. 残存する課題やリスク
5. 今後のメンテナンス推奨事項

## 特に注意すべき最新機能

最近追加された以下の機能については、特に注意深く確認してください：

1. **AIプロンプト生成機能**：
   - ポートフォリオデータをAIアシスタント（Claude、ChatGPT、Gemini）に送信するための構造化プロンプト生成
   - プロンプトテンプレートのカスタマイズ機能
   - 現在の通貨設定（円/ドル）に連動したプロンプト生成

2. **マルチ通貨シミュレーション**：
   - 円/ドル対応の資金配分シミュレーション
   - 為替レートに基づく通貨換算
   - 購入可能株数の表示機能

3. **スクレイピングベースの株価取得**：
   - 複数サイトからの日本株スクレイピング
   - 複数サイトからの投資信託スクレイピング
   - スクレイピング統計情報の表示
   - データソース表示の強化（スクレイピングソース別バッジなど）

以上の観点で確認と更新を行い、ドキュメントとソースコードの整合性を確保してください。
