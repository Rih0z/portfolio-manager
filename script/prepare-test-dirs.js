#!/usr/bin/env node

/**
 * ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹: script/prepare-test-dirs.js
 * 
 * ãƒ†ã‚¹ãƒˆé–¢é€£ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æº–å‚™ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
 * test-resultsãƒ•ã‚©ãƒ«ãƒ€ãªã©ã®å¿…è¦ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™
 * 
 * ä½¿ã„æ–¹:
 *   node script/prepare-test-dirs.js
 */

const fs = require('fs');
const path = require('path');

// ç¾åœ¨ã®ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å–å¾—
const cwd = process.cwd();

console.log('========================================');
console.log('ğŸ”§ ãƒ†ã‚¹ãƒˆç’°å¢ƒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ');
console.log('========================================');

// ä½œæˆã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒªã‚¹ãƒˆ
const directories = [
  'test-results',      // ãƒ†ã‚¹ãƒˆçµæœã®å‡ºåŠ›å…ˆ
  'coverage',          // ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã®å‡ºåŠ›å…ˆ
  '__mocks__'          // ãƒ¢ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«æ ¼ç´ç”¨
];

// ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
directories.forEach(dir => {
  const dirPath = path.join(cwd, dir);
  
  if (!fs.existsSync(dirPath)) {
    fs.mkdirSync(dirPath, { recursive: true });
    console.log(`âœ… ${dir} ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸ`);
  } else {
    console.log(`â„¹ï¸ ${dir} ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯æ—¢ã«å­˜åœ¨ã—ã¾ã™`);
  }
});

console.log('----------------------------------------');
console.log('ãƒ†ã‚¹ãƒˆç’°å¢ƒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æº–å‚™ãŒå®Œäº†ã—ã¾ã—ãŸ');
console.log('----------------------------------------');
